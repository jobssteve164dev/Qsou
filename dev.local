# Qsou 投资情报搜索引擎 - 开发环境配置文件
# 该文件包含本地开发环境的所有配置参数

# ============================================
# 基础配置
# ============================================
PROJECT_NAME="Qsou Investment Intelligence Engine"
PROJECT_VERSION="1.0.0"
ENVIRONMENT="development"
DEBUG=true
LOG_LEVEL="INFO"

# ============================================
# 服务端口配置
# ============================================
API_PORT=8888
FRONTEND_PORT=3333
CELERY_FLOWER_PORT=5555
ELASTICSEARCH_PORT=9200
QDRANT_PORT=6333
POSTGRESQL_PORT=5432
REDIS_PORT=6379

# ============================================
# 统一日志收集配置（Python版本，更高效）
# ============================================
# 启用统一日志收集（默认: true）
# 现在使用Python实现，内存占用大幅降低
ENABLE_UNIFIED_LOG=true

# 统一日志文件最大行数（默认: 50000）
# 超过此行数会自动轮转，保留最近80%的内容
UNIFIED_LOG_MAX_LINES=30000

# 日志收集检查间隔（秒）
LOG_COLLECTOR_CHECK_INTERVAL=2

# 日志收集刷新间隔（秒）- 已废弃，使用CHECK_INTERVAL
LOG_COLLECTOR_REFRESH_INTERVAL=30
PROMETHEUS_PORT=9090
GRAFANA_PORT=3001

# ============================================
# 数据库配置
# ============================================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=qsou_investment_intel
DB_USER=qsou
DB_PASSWORD=your_password
DATABASE_URL="sqlite:///./qsou_dev.db"

# Redis配置
REDIS_HOST=localhost
REDIS_DB_CACHE=0
REDIS_DB_CELERY_BROKER=1
REDIS_DB_CELERY_RESULT=2
REDIS_URL="redis://localhost:6379/0"
CELERY_BROKER_URL="redis://localhost:6379/1"
CELERY_RESULT_BACKEND="redis://localhost:6379/2"

# ============================================
# 搜索引擎配置
# ============================================
ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_INDEX_PREFIX=qsou_
ELASTICSEARCH_HEAP_SIZE=1g

# Qdrant向量数据库配置
QDRANT_HOST=localhost
QDRANT_COLLECTION_NAME=investment_documents
QDRANT_STORAGE_PATH="./qdrant_storage"

# ============================================
# 应用服务配置
# ============================================
# API服务
API_HOST=0.0.0.0
API_WORKERS=1
API_RELOAD=true
API_ACCESS_LOG=true

# 前端服务
FRONTEND_HOST=localhost

# Celery配置
CELERY_WORKERS=4
CELERY_LOGLEVEL=info
CELERY_AUTOSCALE_MAX=8
CELERY_AUTOSCALE_MIN=2

# ============================================
# 爬虫配置
# ============================================
SPIDER_CONCURRENCY=8
DOWNLOAD_DELAY=1
RANDOMIZE_DOWNLOAD_DELAY=0.5
SPIDER_USER_AGENT="Qsou-InvestmentBot/1.0 (+http://your-domain.com/bot; contact@your-domain.com)"
SPIDER_AUTOTHROTTLE_ENABLED=true
SPIDER_AUTOTHROTTLE_START_DELAY=1
SPIDER_AUTOTHROTTLE_MAX_DELAY=60

# ============================================
# AI/ML配置
# ============================================
BERT_MODEL_PATH="bert-base-chinese"
SENTENCE_TRANSFORMER_MODEL="shibing624/text2vec-base-chinese"
EMBEDDING_DIMENSION=768
BATCH_SIZE_EMBEDDING=32
MAX_SEQUENCE_LENGTH=512

# ============================================
# 安全配置
# ============================================
SECRET_KEY="dev-secret-key-change-in-production"
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
CORS_ORIGINS='["http://localhost:3333", "http://127.0.0.1:3333"]'

# ============================================
# 日志配置
# ============================================
LOG_DIR="logs"
LOG_FILE="logs/app.log"
MAX_LOG_SIZE_MB=50
LOG_BACKUP_COUNT=5
LOG_FORMAT="%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# ============================================
# 开发工具配置
# ============================================
# 热重载
AUTO_RELOAD=true
WATCH_DIRS='["api-gateway", "data-processor", "crawler"]'

# 测试配置
TEST_DATABASE_URL="postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/test_${DB_NAME}"
PYTEST_ARGS="-v --tb=short"

# 代码质量
LINT_DIRS='["api-gateway", "data-processor", "crawler", "scripts"]'
FORMAT_ON_SAVE=true

# ============================================
# 监控配置
# ============================================
ENABLE_METRICS=true
METRICS_PORT=9091
HEALTH_CHECK_INTERVAL=30
SERVICE_TIMEOUT=60

# ============================================
# 开发模式特定配置
# ============================================
# 跳过某些检查（仅开发模式）
SKIP_SSL_VERIFY=true
SKIP_AUTH_IN_DEV=false
ENABLE_DEBUG_TOOLBAR=true
SHOW_SQL_QUERIES=false

# 数据填充
LOAD_SAMPLE_DATA=true
SAMPLE_DATA_SIZE=100

# ============================================
# 外部服务配置（开发环境）
# ============================================
# 代理配置（如果需要）
HTTP_PROXY=""
HTTPS_PROXY=""
NO_PROXY="localhost,127.0.0.1"

# 第三方API密钥（开发环境测试用）
FINANCIAL_API_KEY=""
NEWS_API_KEY=""

# ============================================
# 进程管理配置
# ============================================
# PID文件存储目录
PID_DIR="./pids"

# 进程启动等待时间（秒）
SERVICE_START_WAIT=15
SERVICE_STOP_WAIT=10
SERVICE_KILL_WAIT=5

# 健康检查重试次数
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_DELAY=2
HEALTH_CHECK_INITIAL_WAIT=30

# ============================================
# 备份和清理配置
# ============================================
# 自动备份
AUTO_BACKUP=false
BACKUP_DIR="./backups"
BACKUP_RETENTION_DAYS=7

# 日志清理
AUTO_CLEAN_LOGS=true
LOG_RETENTION_DAYS=30

# 临时文件清理
AUTO_CLEAN_TEMP=true
TEMP_RETENTION_HOURS=24
